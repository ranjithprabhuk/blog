import{r as d,j as e,L as p,u as f,P as y}from"./index-CoG2eWBC.js";import{B as u,f as g,P as j,p as v}from"./PostCard-Bj6X9rbt.js";import{A as k}from"./AuthorAvatar-D2zzGaje.js";import{M as b}from"./MetaTags-DxXCXHMi.js";import{f as N,u as w}from"./useMetadata-BKpwp-2h.js";function P({html:s}){const r=d.useRef(null);return d.useEffect(()=>{if(!r.current)return;const l=r.current.querySelectorAll(".copy-btn"),a=[];return l.forEach(t=>{const o=()=>{const c=decodeURIComponent(t.getAttribute("data-code")||"");navigator.clipboard.writeText(c).then(()=>{const n=t.textContent;t.textContent="Copied!",setTimeout(()=>{t.textContent=n},2e3)})};t.addEventListener("click",o),a.push({el:t,handler:o})}),()=>{a.forEach(({el:t,handler:o})=>t.removeEventListener("click",o))}},[s]),e.jsx("div",{ref:r,className:`prose prose-lg dark:prose-invert max-w-none
        prose-headings:scroll-mt-20
        prose-pre:!m-0 prose-pre:!bg-transparent
        prose-code:before:content-none prose-code:after:content-none`,dangerouslySetInnerHTML:{__html:s}})}function E({headings:s}){const[r,l]=d.useState("");return d.useEffect(()=>{const a=new IntersectionObserver(t=>{for(const o of t)o.isIntersecting&&l(o.target.id)},{rootMargin:"-80px 0px -80% 0px"});return s.forEach(({id:t})=>{const o=document.getElementById(t);o&&a.observe(o)}),()=>a.disconnect()},[s]),s.length<2?null:e.jsxs("nav",{className:"hidden xl:block sticky top-24 max-h-[calc(100vh-8rem)] overflow-y-auto","aria-label":"Table of contents",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"On this page"}),e.jsx("ul",{className:"space-y-1 text-sm",children:s.filter(a=>a.level<=3).map(a=>e.jsx("li",{style:{paddingLeft:`${(a.level-2)*12}px`},children:e.jsx("a",{href:`#${a.id}`,className:`block py-1 transition-colors ${r===a.id?"text-primary-600 dark:text-primary-400 font-medium":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:a.text})},a.id))})]})}function C({post:s,prevPost:r,nextPost:l,recentPosts:a=[]}){const{frontmatter:t,html:o,headings:c}=s;return e.jsxs(e.Fragment,{children:[e.jsx(b,{title:t.title,description:t.excerpt,type:"article"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-8",children:[e.jsxs(p,{to:"/",className:"inline-flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors mb-8",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to posts"]}),e.jsxs("div",{className:"flex gap-12",children:[e.jsxs("article",{className:"min-w-0 flex-1 max-w-3xl",children:[e.jsxs("header",{className:"mb-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx(u,{label:t.category,to:`/category/${encodeURIComponent(t.category)}`,variant:"primary"})}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-6 leading-tight tracking-tight",children:t.title}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{name:t.author,size:"md"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.author}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("time",{dateTime:t.date,children:g(t.date)}),t.updated!==t.date&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"·"}),e.jsxs("span",{children:["Updated ",g(t.updated)]})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-gray-400 dark:text-gray-500 leading-tight",children:"Read time"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:[t.readingTime," min"]})]})]})]}),e.jsx(P,{html:o}),e.jsx("div",{className:"mt-10 pt-6 border-t border-gray-200 dark:border-gray-800",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map(n=>e.jsx(u,{label:n,to:`/tag/${encodeURIComponent(n)}`},n))})}),(r||l)&&e.jsxs("nav",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-800 grid grid-cols-1 sm:grid-cols-2 gap-4","aria-label":"Post navigation",children:[r?e.jsxs(p,{to:`/post/${r.slug}`,className:"group p-4 border border-gray-200 dark:border-gray-800 rounded-xl hover:border-primary-300 dark:hover:border-primary-700 hover:shadow-sm transition-all",children:[e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"← Previous"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 mt-1 line-clamp-2",children:r.title})]}):e.jsx("div",{}),l&&e.jsxs(p,{to:`/post/${l.slug}`,className:"group p-4 border border-gray-200 dark:border-gray-800 rounded-xl hover:border-primary-300 dark:hover:border-primary-700 hover:shadow-sm transition-all text-right",children:[e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Next →"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 mt-1 line-clamp-2",children:l.title})]})]})]}),e.jsx("aside",{className:"hidden xl:block w-56 shrink-0",children:e.jsx(E,{headings:c})})]}),a.length>0&&e.jsxs("section",{className:"mt-16 pt-10 border-t border-gray-200 dark:border-gray-800",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white tracking-tight mb-6",children:"Recent Articles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(n=>e.jsx(j,{post:n},n.slug))})]})]})]})}function I(s,r){const[l,a]=d.useState(null),[t,o]=d.useState(!0),[c,n]=d.useState(null);return d.useEffect(()=>{if(!s||!r){o(!1),n("Post not found");return}let x=!1;async function i(){try{o(!0),n(null);const m=await N(s,r);if(!x){const h=v(m,s,r);a(h)}}catch(m){x||n(m instanceof Error?m.message:"Failed to load post")}finally{x||o(!1)}}return i(),()=>{x=!0}},[s,r]),{post:l,loading:t,error:c}}function S(){const{slug:s}=f(),{index:r}=w(),{postInfo:l,prevPost:a,nextPost:t}=d.useMemo(()=>{if(!r||!s)return{postInfo:null,prevPost:null,nextPost:null};const i=r.posts.findIndex(m=>m.slug===s);return i===-1?{postInfo:null,prevPost:null,nextPost:null}:{postInfo:r.posts[i],prevPost:i>0?r.posts[i-1]:null,nextPost:i<r.posts.length-1?r.posts[i+1]:null}},[r,s]),o=d.useMemo(()=>!r||!s?[]:r.posts.filter(i=>i.slug!==s).slice(0,3),[r,s]),{post:c,loading:n,error:x}=I(l?.folder,l?.postId);return n?e.jsx(y,{}):x||!c?e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-16 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Post not found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:x||"The post you're looking for doesn't exist."})]}):e.jsx(C,{post:c,prevPost:a,nextPost:t,recentPosts:o})}export{S as default};
