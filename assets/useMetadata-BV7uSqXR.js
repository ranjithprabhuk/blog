import{r}from"./index-D4eyzbcy.js";import{g as m,c as u}from"./MetaTags-CXyNOh-h.js";const i="blog_cache_";function l(t){try{const a=localStorage.getItem(i+t);if(!a)return null;const e=JSON.parse(a);return Date.now()-e.timestamp>e.ttl?(localStorage.removeItem(i+t),null):e.data}catch{return null}}function f(t,a,e){try{const n={data:a,timestamp:Date.now(),ttl:e};localStorage.setItem(i+t,JSON.stringify(n))}catch{}}async function d(t){const a=m(t),e=await fetch(a);if(!e.ok)throw new Error(`Failed to fetch ${t}: ${e.status}`);return e.text()}async function y(){const t=l("metadata");if(t)return t;const a=await d("metadata.json"),e=JSON.parse(a);return f("metadata",e,u.cache.metadataTTL),e}async function S(){const t=l("index");if(t)return t;const a=await d("index.json"),e=JSON.parse(a);return f("index",e,u.cache.metadataTTL),e}async function $(t,a){const e=`post_${t}_${a}`,n=l(e);if(n)return n;const c=await d(`${t}/${a}/post.md`);return f(e,c,u.cache.postTTL),c}function C(t){return m(t)}function I(){const[t,a]=r.useState(null),[e,n]=r.useState(null),[c,h]=r.useState(!0),[g,w]=r.useState(null);return r.useEffect(()=>{let s=!1;async function p(){try{const[o,x]=await Promise.all([y(),S()]);s||(a(o),n(x))}catch(o){s||w(o instanceof Error?o.message:"Failed to load blog data")}finally{s||h(!1)}}return p(),()=>{s=!0}},[]),{metadata:t,index:e,loading:c,error:g}}export{$ as f,C as g,I as u};
